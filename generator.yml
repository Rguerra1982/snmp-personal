# Bloque de Autenticación
# El usuario debe modificar 'YourSecureCommunityString', nombres de usuario y contraseñas.
auths:
  comunidad_lectura_v2c: # Para la mayoría de los dispositivos que usan SNMPv2c
    version: 2
    community: IUNGO-NOC # ¡CAMBIAR ESTO!
# Definición de Módulos
modules:
  # Módulo para Servidores Windows
  windows:
    walk:
      - hrSystemUptime
      - hrStorageTable
      - hrMemorySize
      - hrProcessorTable
      # - entPhySensorTable # Descomentar si se sospecha soporte para temperatura vía ENTITY-SENSOR-MIB
    lookups:
      - source_indexes:
        lookup: hrStorageDescr
      # - source_indexes: # Si se usa entPhySensorTable
      #   lookup: entPhysicalDescr
    overrides:
      hrSystemUptime:
        name: windows_system_uptime_seconds # hrSystemUptime es TimeTicks (centésimas de seg)
                                            # Prometheus lo manejará, pero el nombre puede ser más claro
      hrStorageType:
        type: EnumAsInfo
      hrStorageSize:
        name: windows_storage_size_units
      hrStorageUsed:
        name: windows_storage_used_units
      hrStorageAllocationUnits:
        name: windows_storage_allocation_unit_bytes
      hrMemorySize:
        name: windows_physical_memory_total_kbytes
      hrProcessorLoad:
        name: windows_processor_load_percent
      # entPhySensorValue: # Si se usa entPhySensorTable para temperatura
      #   name: windows_sensor_temperature_celsius

  # Módulo base común para interfaces de red
  if_mib_common:
    walk:
      - sysUpTime
      - interfaces # ifTable
      - ifXTable   # ifXTable para contadores de 64 bits
    lookups:
      - source_indexes: [ifIndex]
        lookup: ifDescr
      - source_indexes: [ifIndex]
        lookup: ifAlias
      - source_indexes: [ifIndex]
        lookup: ifName
    overrides:
      ifAdminStatus:
        type: EnumAsStateSet
        name: interface_admin_status
      ifOperStatus:
        type: EnumAsStateSet
        name: interface_oper_status
      ifType:
        type: EnumAsInfo
        name: interface_type
      ifHCInOctets:
        type: counter
        name: interface_in_octets_total
      ifHCOutOctets:
        type: counter
        name: interface_out_octets_total
      ifInOctets: # Contador de 32 bits
        type: counter
        name: interface_in_octets_32bit_total
      ifOutOctets: # Contador de 32 bits
        type: counter
        name: interface_out_octets_32bit_total
      ifSpeed:
        name: interface_speed_bits_per_second

  # Módulo para Dispositivos Cisco
  cisco_devices:
    walk:
      # Incluir OIDs de if_mib_common (o referenciarlo si el generador lo permite)
      - sysUpTime
      - interfaces
      - ifXTable
      # Específicos de Cisco
      - ciscoEnvMonTemperatureStatusTable # CISCO-ENVMON-MIB
      - ciscoMemoryPoolTable            # CISCO-MEMORY-POOL-MIB
      - entidadSensorMIB # Para ENTITY-SENSOR-MIB si es necesario
    lookups:
      - source_indexes: [ifIndex]
        lookup: ifDescr
      - source_indexes: [ifIndex]
        lookup: ifAlias
      - source_indexes: [ifIndex]
        lookup: ifName
      - source_indexes:
        lookup: ciscoEnvMonTemperatureStatusDescr
      - source_indexes: [ciscoMemoryPoolIndex]
        lookup: ciscoMemoryPoolName
      # - source_indexes: # Si se usa ENTITY-SENSOR-MIB
      #   lookup: entPhysicalDescr
    overrides:
      # Overrides de if_mib_common (o copiar/pegar)
      ifAdminStatus: {type: EnumAsStateSet, name: interface_admin_status}
      ifOperStatus: {type: EnumAsStateSet, name: interface_oper_status}
      ifType: {type: EnumAsInfo, name: interface_type}
      ifHCInOctets: {type: counter, name: interface_in_octets_total}
      ifHCOutOctets: {type: counter, name: interface_out_octets_total}
      ifSpeed: {name: interface_speed_bits_per_second}
      # Específicos de Cisco
      ciscoEnvMonTemperatureStatusValue:
        name: cisco_envmon_temperature_celsius
      ciscoMemoryPoolUsed:
        name: cisco_memory_pool_used_bytes
      ciscoMemoryPoolFree:
        name: cisco_memory_pool_free_bytes
      # entPhySensorValue: # Si se usa ENTITY-SENSOR-MIB para temperatura
      #   name: cisco_sensor_temperature_celsius

  # Módulo para Dispositivos Meraki
  meraki_devices:
    walk:
      # IF-MIB (similar a if_mib_common)
      - sysUpTime
      - interfaces
      - ifXTable
      # HOST-RESOURCES-MIB para memoria
      - hrMemorySize
      - hrStorageTable # Para detalles de memoria si es necesario
      # ENTITY-SENSOR-MIB para temperatura (si soportado)
      - entPhySensorTable
    lookups:
      - source_indexes: [ifIndex]
        lookup: ifDescr
      - source_indexes: [ifIndex]
        lookup: ifAlias
      - source_indexes: [ifIndex]
        lookup: ifName
      - source_indexes: # Para memoria de hrStorageTable
        lookup: hrStorageDescr
      - source_indexes: # Si se usa ENTITY-SENSOR-MIB
        lookup: entPhysicalDescr
    overrides:
      # Overrides de IF-MIB (similar a if_mib_common)
      ifAdminStatus: {type: EnumAsStateSet, name: interface_admin_status}
      ifOperStatus: {type: EnumAsStateSet, name: interface_oper_status}
      ifType: {type: EnumAsInfo, name: interface_type}
      ifHCInOctets: {type: counter, name: interface_in_octets_total}
      ifHCOutOctets: {type: counter, name: interface_out_octets_total}
      ifSpeed: {name: interface_speed_bits_per_second}
      # Específicos de Meraki (basados en MIBs estándar)
      hrMemorySize:
        name: meraki_physical_memory_total_kbytes
      hrStorageType: # Para identificar RAM en hrStorageTable
        type: EnumAsInfo
      entPhySensorValue: # Para temperatura de ENTITY-SENSOR-MIB
        name: meraki_sensor_temperature_celsius
        # Considerar 'scale' si la temperatura viene en décimas de grado, ej: scale: 0.1

  # Módulo para Dispositivos Sophos Firewall
  sophos_firewall:
    walk:
      # IF-MIB
      - sysUpTime
      - interfaces
      - ifXTable
      # HOST-RESOURCES-MIB para memoria y CPU
      - hrMemorySize
      - hrStorageTable
      - hrProcessorTable
      # Consultar MIB de Sophos o ENTITY-SENSOR-MIB para temperatura
      # -... OIDs de SOPHOS-MIB para temperatura...
      # - entPhySensorTable
    lookups:
      - source_indexes: [ifIndex]
        lookup: ifDescr
      - source_indexes: [ifIndex]
        lookup: ifAlias
      - source_indexes: [ifIndex]
        lookup: ifName
      - source_indexes:
        lookup: hrStorageDescr
      # - source_indexes:
      #   lookup: entPhysicalDescr
    overrides:
      # Overrides de IF-MIB
      ifAdminStatus: {type: EnumAsStateSet, name: interface_admin_status}
      ifOperStatus: {type: EnumAsStateSet, name: interface_oper_status}
      ifType: {type: EnumAsInfo, name: interface_type}
      ifHCInOctets: {type: counter, name: interface_in_octets_total}
      ifHCOutOctets: {type: counter, name: interface_out_octets_total}
      ifSpeed: {name: interface_speed_bits_per_second}
      # Específicos de Sophos (basados en MIBs estándar)
      hrMemorySize:
        name: sophos_physical_memory_total_kbytes
      hrProcessorLoad:
        name: sophos_processor_load_percent
      # entPhySensorValue: # Para temperatura
      #   name: sophos_sensor_temperature_celsius

  # Módulo para Dispositivos Fortinet Firewall
  fortinet_firewall:
    walk:
      # IF-MIB
      - sysUpTime
      - interfaces
      - ifXTable
      # FORTINET-FORTIGATE-MIB para memoria, temperatura, VPNs
      - 1.3.6.1.4.1.12356.101.4.1.3  # fgSysMemCapacity
      - 1.3.6.1.4.1.12356.101.4.1.4  # fgSysMemUsage
      # -... otros OIDs de Fortinet para temperatura, CPU...
      - 1.3.6.1.4.1.12356.101.12.2.2.1 # fgVpnTunEntTable (tabla de túneles VPN)
      # - entPhySensorTable # Si Fortinet soporta ENTITY-SENSOR-MIB para temp.
    lookups:
      - source_indexes: [ifIndex]
        lookup: ifDescr
      - source_indexes: [ifIndex]
        lookup: ifAlias
      - source_indexes: [ifIndex]
        lookup: ifName
      # Lookup para nombres de túneles VPN
      - source_indexes: # Asumiendo este es el nombre del índice
        lookup: 1.3.6.1.4.1.12356.101.12.2.2.1.1 # fgVpnTunEntName
    overrides:
      # Overrides de IF-MIB
      ifAdminStatus: {type: EnumAsStateSet, name: interface_admin_status}
      ifOperStatus: {type: EnumAsStateSet, name: interface_oper_status}
      ifType: {type: EnumAsInfo, name: interface_type}
      ifHCInOctets: {type: counter, name: interface_in_octets_total}
      ifHCOutOctets: {type: counter, name: interface_out_octets_total}
      ifSpeed: {name: interface_speed_bits_per_second}
      # Específicos de Fortinet
      fgSysMemCapacity:
        name: fortinet_memory_total_kbytes
      fgSysMemUsage:
        name: fortinet_memory_usage_percent
      # fgVpnTunEntStatus: # OID:.1.3.6.1.4.1.12356.101.12.2.2.1.20
      #   type: EnumAsStateSet
      #   name: fortinet_vpn_tunnel_status

  # Módulo para SAI APC
  apc_ups:
    walk:
      # UPS-MIB
      - upsIdentManufacturer
      - upsIdentModel
      - upsBatteryStatus
      - upsEstimatedMinutesRemaining
      - upsEstimatedChargeRemaining
      - upsOutputSource
      - upsAlarmsTable
      # PowerNet-MIB (APC específico)
      - upsAdvBatteryReplaceIndicator
      - upsAdvBatteryTemperature
      - upsBasicOutputStatus
      - upsAdvOutputLoad
      - upsHighPrecBatteryCapacity
      - upsHighPrecOutputLoad
      - 1.3.6.1.4.1.318.1.1.10.2.3.2.1 # Base para tabla de sensores ambientales
      - upsAdvStateAbnormalConditions
    lookups:
      - source_indexes: [upsAlarmId]
        lookup: upsAlarmDescr
      # Lookup para sensores ambientales (ej. nombre del sensor)
      # - source_indexes: # Asumiendo un índice para la tabla de sensores
      #   lookup: 1.3.6.1.4.1.318.1.1.10.2.3.2.1.2 # upsEnvSensorName
    overrides:
      upsBatteryStatus:
        type: EnumAsStateSet
        name: apc_ups_battery_status
      upsOutputSource:
        type: EnumAsStateSet
        name: apc_ups_output_source
      upsBasicOutputStatus:
        type: EnumAsStateSet
        name: apc_ups_basic_output_status
      upsAdvBatteryReplaceIndicator:
        type: EnumAsInfo
        name: apc_ups_battery_replace_indicator
      upsAdvBatteryTemperature:
        name: apc_ups_battery_temperature_celsius
      upsHighPrecBatteryCapacity:
        name: apc_ups_battery_capacity_percent
      upsHighPrecOutputLoad:
        name: apc_ups_output_load_percent
      # upsEnvAmbientTemperature: # Si se usa el OID de la tabla de sensores.1.3.6.1.4.1.318.1.1.10.2.3.2.1.4
      #   name: apc_ups_ambient_temperature_celsius
      upsAdvStateAbnormalConditions:
        name: apc_ups_abnormal_conditions_flags
        # Podría necesitar regex_extracts si es una cadena de máscara de bits compleja
